<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>utils\utils.js</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="../assets/css/logo.png" title=""></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: </em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="../classes/AutoSuggest.html">AutoSuggest</a></li>
            
                <li><a href="../classes/Bookmark.html">Bookmark</a></li>
            
                <li><a href="../classes/ClosablePopup.html">ClosablePopup</a></li>
            
                <li><a href="../classes/DetailsBox.html">DetailsBox</a></li>
            
                <li><a href="../classes/Dictionary.html">Dictionary</a></li>
            
                <li><a href="../classes/DictionaryController.html">DictionaryController</a></li>
            
                <li><a href="../classes/DictionaryEntity.html">DictionaryEntity</a></li>
            
                <li><a href="../classes/DocumentApp.html">DocumentApp</a></li>
            
                <li><a href="../classes/DocumentList.html">DocumentList</a></li>
            
                <li><a href="../classes/DocumentMobileApp.html">DocumentMobileApp</a></li>
            
                <li><a href="../classes/DynamicMenu.html">DynamicMenu</a></li>
            
                <li><a href="../classes/LabelItem.html">LabelItem</a></li>
            
                <li><a href="../classes/LabelList.html">LabelList</a></li>
            
                <li><a href="../classes/Landscape.html">Landscape</a></li>
            
                <li><a href="../classes/LeftHeader.html">LeftHeader</a></li>
            
                <li><a href="../classes/LeftPanel.html">LeftPanel</a></li>
            
                <li><a href="../classes/LocationViewer.html">LocationViewer</a></li>
            
                <li><a href="../classes/LoginPopup.html">LoginPopup</a></li>
            
                <li><a href="../classes/MenuController.html">MenuController</a></li>
            
                <li><a href="../classes/MiddlePanel.html">MiddlePanel</a></li>
            
                <li><a href="../classes/NGraph.html">NGraph</a></li>
            
                <li><a href="../classes/OpenedDoc.html">OpenedDoc</a></li>
            
                <li><a href="../classes/OpenedDocHeader.html">OpenedDocHeader</a></li>
            
                <li><a href="../classes/PredicateAnnotator.html">PredicateAnnotator</a></li>
            
                <li><a href="../classes/PredicateItem.html">PredicateItem</a></li>
            
                <li><a href="../classes/PreviewBox.html">PreviewBox</a></li>
            
                <li><a href="../classes/RightPanel.html">RightPanel</a></li>
            
                <li><a href="../classes/SearchBox.html">SearchBox</a></li>
            
                <li><a href="../classes/ShortDocument.html">ShortDocument</a></li>
            
                <li><a href="../classes/TopMessageBox.html">TopMessageBox</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
                <li><a href="../modules/Firstswim.html">Firstswim</a></li>
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: utils\utils.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">

function placeDefaultCookies() {
	if(isEmpty(readCookie(&#x27;currentUser&#x27;))) { createCookie(&#x27;currentUser&#x27;, &#x27;anonymous&#x27;, 30); }
	if(isEmpty(readCookie(&#x27;maxFacets&#x27;))) { createCookie(&#x27;maxFacets&#x27;, 10, 30); }
	if(isEmpty(readCookie(&#x27;minClassifyDoc&#x27;))) { createCookie(&#x27;minClassifyDoc&#x27;, 10, 30); }
	if(isEmpty(readCookie(&#x27;items&#x27;))) { createCookie(&#x27;items&#x27;, 10, 30); }
	if(isEmpty(readCookie(&#x27;nodeLimit&#x27;))) { createCookie(&#x27;nodeLimit&#x27;, [1,5,3,3], 30); }
	if(isEmpty(readCookie(&#x27;viewType&#x27;))) { createCookie(&#x27;viewType&#x27;, &#x27;documentList&#x27;, 30); }
	if(isEmpty(readCookie(&#x27;labelPrediction&#x27;))) { createCookie(&#x27;labelPrediction&#x27;, 1, 30); }
	if(isEmpty(readCookie(&#x27;userLabels&#x27;))) { createCookie(&#x27;userLabels&#x27;, [], 30); }
	if(isEmpty(readCookie(&#x27;css&#x27;))) { createCookie(&#x27;css&#x27;, &#x27;firstswim&#x27;, 30); }
}

// var BASE_URL = &#x27;http://localhost:8080/&#x27;;
// var BASE_URL = &#x27;http://platform.fusepool.info/&#x27;;
var BASE_URL = &#x27;/&#x27;;

var CONSTANTS = {
    SEARCH_URL: BASE_URL + &#x27;ecs/&#x27;,
    ENTITY_SEARCH_URL: BASE_URL + &#x27;firstswim/entitysearch/&#x27;,
    ENTITY_DETAILS_URL: BASE_URL + &#x27;firstswim/entitydetails/&#x27;,
    DETAILS_URL: BASE_URL + &#x27;ecs/meta&#x27;,
    GET_PREDICATES_URL: BASE_URL + &#x27;firstswim/getpredicates&#x27;,
    CLASSIFY_URL: BASE_URL + &#x27;kmxrdfproxy/ranking/&#x27;,
    LANDSCAPE_URL: BASE_URL + &#x27;kmxrdfproxy/landscape/&#x27;,
    ANNOTATION_URL: BASE_URL + &#x27;annostore/&#x27;,
    GET_LABELS_URL: BASE_URL + &#x27;firstswim/getlabels/&#x27;,
    GET_USER_LABELS_URL: BASE_URL + &#x27;firstswim/getuserlabels/&#x27;,
    OPEN_DOC_URL: BASE_URL + &#x27;ecs/meta&#x27;,
    ADDRESS_URL: BASE_URL + &#x27;ecs/meta&#x27;,
	SELFREG_URL: BASE_URL + &#x27;selfregistration/&#x27;,
	CURRENTUSER_URL: BASE_URL + &#x27;selfregistration/currentUser&#x27;,
	SIGNIN_URL: BASE_URL + &#x27;firstswim/authUser/&#x27;,
    AUTOSUGGEST_URL: BASE_URL + &#x27;solr/default/suggester/sbsuggest?df=id&amp;wt=json&#x27;,
    DETAILS_SUBJECT_URL: &#x27;http://fusepool.info/id/&#x27;,
    FUSEPOOL_MAIN_URL: &#x27;http://www.fusepool.eu&#x27;,

    // CLIPBOARD_COPY_PATH: &#x27;../../../../../META-INF/resources/firstswim/javascript/zeroclipboard/ZeroClipboard.swf&#x27;, 
    // TEMPLATES_URL: &#x27;../../../../../META-INF/resources/firstswim/templates/templates.html&#x27;,
    // VISUALIZER_URL: &#x27;../../../../../META-INF/resources/firstswim/templates/visualizer.html&#x27;,
    // IMG_PATH: &#x27;../../../../../META-INF/resources/firstswim/images/&#x27;,
    // STYLE_PATH: &#x27;../../../../../META-INF/resources/firstswim/styles/&#x27;
    CLIPBOARD_COPY_PATH: &#x27;firstswim/javascript/zeroclipboard/ZeroClipboard.swf&#x27;,
    TEMPLATES_URL: BASE_URL + &#x27;firstswim/templates/templates.html&#x27;,
    VISUALIZER_URL: BASE_URL + &#x27;firstswim/templates/visualizer.html&#x27;,
    IMG_PATH: BASE_URL + &#x27;firstswim/images/&#x27;,
    STYLE_PATH: BASE_URL + &#x27;firstswim/styles/&#x27;
};

/**
 * This function queries the platform for the current, logged in user
 * and sets the currentUser cookie value.
 * @method setCurrentUser
 */
function setCurrentUser() {
	var request = new enyo.Ajax({
		method: &#x27;GET&#x27;,
		url: CONSTANTS.CURRENTUSER_URL,
		handleAs: &#x27;text&#x27;,
		headers: { Accept: &#x27;text/plain&#x27;, &#x27;Content-Type&#x27; : &#x27;text/turtle&#x27;},
		postBody: null,
		published: { timeout: 60000 }
	});
	request.go();
	request.response(this, function(inSender, inResponse) {
		createCookie(&#x27;currentUser&#x27;, inResponse, 30);
	});
}

/**
 * This function creates a cookie using the parameter values.
 * @method createCookie
 * @param {String} name name of the cookie
 * @param {String} value cookie value
 * @param {Number} days days until expiration
 */
function createCookie(name, value, days) {
	$.cookie(name, value, { expires: days });
}

/**
 * This function returns a cookie.
 * @method readCookie
 * @param {String} name name of the cookie
 * @return {String} cookie value
 */
function readCookie(name) {
    return $.cookie(name);
}

/**
 * This function deletes a cookie.
 * @method eraseCookie
 * @param {String} name name of the cookie
 */
function eraseCookie(name) {
    $.removeCookie(name);
}

/**
 * Checks whether the data is empty or not.
 * @method isEmpty
 * @param {Object} data the data what the function checks
 * @return {Boolean} true, if data is empty, false, if data is not empty
 */
function isEmpty(data){
    if(typeof data === &#x27;undefined&#x27; || data === &#x27;&#x27; || data === null){
        return true;
    }
    return false;
}

/**
 * This function formats the given string and clears the html tags
 * that could cause trouble on the GUI. It is using jquery-clean jQuery plug-in.
 * @method removeTags
 * @param {String} string to be cleaned
 * @return {String} clean string
*/
function removeTags(str) {
	var tagWhiteList = [&quot;b&quot;, &quot;big&quot;, &quot;i&quot;, &quot;small&quot;, &quot;tt&quot;, &quot;abbr&quot;, &quot;acronym&quot;, &quot;cite&quot;, &quot;code&quot;, &quot;dfn&quot;, &quot;em&quot;, &quot;kbd&quot;, &quot;strong&quot;, &quot;samp&quot;, &quot;var&quot;, &quot;bdo&quot;, &quot;br&quot;, &quot;q&quot;, &quot;span&quot;, &quot;sub&quot;, &quot;sup&quot;, &quot;label&quot;];
	return $.htmlClean(str, {format: true, allowedTags: tagWhiteList });
}

/**
 * This function checks whether the length of a given text is between
 * a minimum and a maximum value.
 * @method textLengthBetween
 * @param {String} text the text to checks
 * @param {Number} min minimum length
 * @param {Number} max maximum length
 * @return {Boolean} true, if the text&#x27;s length is greater or equals the minimum length
 * and shorter or equals the maximum length
 */
function textLengthBetween(text, min, max){
    if(isEmpty(text)){
        return false;
    }
    if(text.length &gt;= min &amp;&amp; text.length &lt;= max){
        return true;
    }
    return false;
}

/**
 * This function gets a parameter name and returns an array that contain every
 * value that can be found in the GET variables under this parameter name.
 * For example when the URL contains x=1&amp;x=2, the result array will be [1,2].
 * @method GetURLParameter
 * @param {String} paramName the name of the GET parameter
 * @return {Array} the result array (empty if the parameter does not exist)
 */
function GetURLParameter(paramName){
    var result = [];
    var sPageURL = window.location.search.substring(1);
    var sURLVariables = sPageURL.split(&#x27;&amp;&#x27;);
    for (var i = 0; i &lt; sURLVariables.length; i++){
        var parameterName = sURLVariables[i].split(&#x27;=&#x27;);
        if (parameterName[0] === paramName){
            result.push(decodeURIComponent(parameterName[1]));
        }
    }
    return result;
}

/**
 * This function replaces every occurences of a string with another string.
 * @method replaceAll
 * @param {String} text text that the function checks
 * @param {String} from text to be replaced
 * @param {String} to text to replace with
 * @param {Boolean} decodeURI decode URI or not
 * @return {String} if the text is not empty, the replaced text with trim, else an empty text
 */
function replaceAll(text, from, to, decodeURI){
    if(!isEmpty(text)){
        var re = new RegExp(from, &#x27;g&#x27;);
        var replacedText = text.replace(re, to).trim();
        if(!isEmpty(decodeURI) &amp;&amp; decodeURI){
            return decodeURIComponent(replacedText);
        }
        return replacedText;
    } else {
        return &#x27;&#x27;;
    }
}

/**
 * This function replaces every occurences of a string with another string 
 * between &#x27;startTag&#x27; and &#x27;endTag&#x27;.
 * @method replaceAllInTags
 * @param {String} text what the function checks
 * @param {String} fromText replacing text
 * @param {String} toText purpose text
 * @param {String} startTag the start character of the replacing
 * @param {String} endTag the end character of replacing
 * @return {String} if the text is not empty, the replaced text with trim, else an empty text
 */
function replaceAllInTags(text, fromText, toText, startTag, endTag){
    var resultText = &#x27;&#x27;;
    if(!isEmpty(text)){
        var startIndex;
        if(!isEmpty(startTag)){
            startIndex = text.indexOf(startTag);
        } else {
            startIndex = 0;
        }
        var endIndex;
        if(!isEmpty(endTag)){
            endIndex = text.lastIndexOf(endTag);
        } else {
            endIndex = text.length;
        }
        for(var i=0;i&lt;text.length;i++){
            if(startIndex &lt; i &amp;&amp; i &lt; endIndex &amp;&amp; text[i] === fromText){
                resultText += toText;
            } else {
                resultText += text[i];
            }
        }
        return resultText;
    } else {
        return &#x27;&#x27;;
    }
}

/**
 * Delete speech marks (&quot;) from the first and last character of a text.
 * @method deleteSpeechMarks
 * @param {String} text the text what the function check
 * @return {String} the string without &quot; characters
 */
function deleteSpeechMarks(text){
    var result = text;
    if(result.charAt(0) === &#x27;&quot;&#x27;){
        result = result.substr(1);
    }
    if(result.charAt(result.length-1) === &#x27;&quot;&#x27;){
        result = result.substr(0, result.length-1);
    }
    return result;
}

/**
 * This functions returns a property&#x27;s value from an rdf object using RDFStore.
 * @method getRDFPropertyValue
 * @param {Object} rdf the rdf object
 * @param {String} propertyName the name of the property
 * @return {String} the property&#x27;s value
 */
function getRDFPropertyValue(rdf, propertyName){
    var result = &#x27;&#x27;;
    var query = &#x27;SELECT * { ?s &lt;&#x27; + propertyName + &#x27;&gt; ?o }&#x27;;
    rdf.execute(query, function(success, results) {
        if (success &amp;&amp; results.length &gt; 0) {
            result = results[0].o.value;
        }
    });
    return result;
}

/**
 * This function gets an rdf object, an existing subject and an exclude array 
 * and gives back a value from a random property that has been found in the rdf
 * connected to the given subject and does not exist in the exclude array.
 * @method getAPropertyValue
 * @param {Object} rdf the rdf object
 * @param {String} subject URI of the subject
 * @param {Array} exclude array of properties to exclude
 * @return {String} the value of a found property 
 */
function getAPropertyValue(rdf, subject, exclude) {
	var prop = &#x27;&#x27;;
	var query = &#x27;SELECT * { &lt;&#x27;+subject+&#x27;&gt; ?p ?o }&#x27;;
	rdf.execute(query, function(success, results) {
		if (success &amp;&amp; results.length &gt; 0) {
			for(var i=0;i &lt; results.length;i++) {
				if($.inArray(results[i].p.value, exclude)==-1) {
					prop = results[i].o.value;
					break;
				}
			}
		}
	});
	return prop;
}

/**
 * This function places an annotation in the Annostore.
 * @method sendAnnotation
 * @param {String} annotationString body of the annotation
 */
function sendAnnotation(annotationString) {
	
	var request = new enyo.Ajax({
		method: &#x27;POST&#x27;,
		url: CONSTANTS.ANNOTATION_URL,
		handleAs: &#x27;text&#x27;,
		headers: { Accept : &#x27;application/rdf+xml&#x27;, &#x27;Content-Type&#x27; : &#x27;text/turtle&#x27;},
		postBody: annotationString,
		published: { timeout: 60000 }
	});
	request.go();
	request.error(this, function(){
		// console.log(&quot;error&quot;);
	});
	request.response(this, function(inSender, inResponse) {
		// console.log(&quot;success: &quot;+inResponse);
	});
}

/**
 * This function cuts the given string at the given length
 * if the string is longer than this length, adds an ellipsis 
 * character to the end, then returns the new string.
 * @method cutStr
 * @param {String} str the string
 * @param {Number} val cutting length
 */
function cutStr(str, val) {
	if(str.length &gt; val) {
		str = str.substring(0,val);
		var lastSpace = str.lastIndexOf(&quot; &quot;);
		if (lastSpace &gt; 0){
			str = str.substring(0,lastSpace+1);	
		}
		str = str+&#x27;…&#x27;;
	}
	return str;
}

/**
 * This function queries the server for the user&#x27;s own labels
 * and places them in a cookie.
 * @method getUserLabels
 * @param {String} userName username
 */
function getUserLabels(userName) {
	var request = new enyo.Ajax({
		method: &#x27;GET&#x27;,
		url: CONSTANTS.GET_USER_LABELS_URL+&#x27;?user=&#x27;+userName,
		handleAs: &#x27;text&#x27;,
		headers: { Accept : &#x27;application/json&#x27;, &#x27;Content-Type&#x27; : &#x27;application/x-www-form-urlencoded&#x27; },
		published: { timeout: 60000 }
	});
	request.go();	
	request.response(this, function(inSender, inResponse) {
		var obj = JSON.parse(inResponse);
		createCookie(&#x27;userLabels&#x27;, obj.userLabels, 30);
	});
}


    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
